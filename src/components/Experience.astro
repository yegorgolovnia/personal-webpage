---
const experiences = [
    {
        role: "Program & Product Lead",
        company: "Giveth",
        period: "Jan 2024 – Present",
        desc: "Leading Quadratic Funding rounds to allocate resources to high-impact public goods. optimizing donor engagement and sybil defense mechanisms.",
        hover_bullets: [
            "Orchestrated $1M+ in QF rounds",
            "Designed Sybil-resistance strategy",
            "Managed cross-functional product squads",
        ],
        tags: ["Product Mgmt", "Quadratic Funding", "Operations"],
        location: "Remote / Barcelona",
    },
    {
        role: "Contributor (Security & Ops)",
        company: "The DAO Security Fund",
        period: "Current",
        desc: "Coordinating whitehat security initiatives and safeguarding the Ethereum ecosystem. Leveraging historical DAO funds to bolster network resilience.",
        hover_bullets: [
            "Whitehat coordination",
            "Fund governance & allocation",
            "Ecosystem resilience planning",
        ],
        tags: ["Security", "DAO Gov", "Ops"],
        location: "Remote",
    },
    {
        title: "Monero Meetups BCN",
        role: "Co-organizer",
        desc: "Privacy-focused community building. Hosting monthly events on cryptography and digital rights in Barcelona.",
        hover_bullets: [
            "Monthly event production",
            "Speaker curation (Privacy/Crypto)",
            "Community growth strategy",
        ],
        tags: ["Privacy", "Events", "Community"],
        location: "Barcelona, Spain",
    },
    {
        role: "Co-Founder & Operations Lead",
        company: "ETHBarcelona",
        period: "2022 – 2024",
        desc: "Scaled a localized Web3 conference to 2,500+ attendees. Managed production, staffing, and infinite operational chaos.",
        hover_bullets: [
            "Scaled to 2,500+ attendees",
            "Managed $500k+ budget",
            "Led 30+ core team & vols",
        ],
        tags: ["Event Ops", "Leadership", "Ethereum"],
        location: "Barcelona, Spain",
    },
];
---

<section id="experience">
    <div class="header">
        <h2>Experience</h2>
        <span class="mono">/log</span>
    </div>

    <div class="timeline">
        {
            experiences.map((exp, index) => (
                <button
                    type="button"
                    class="entry hover-trigger"
                    data-hover-data={JSON.stringify(exp)}
                    aria-label={`Open details for ${exp.title || exp.role}`}
                >
                    <div class="meta mono">
                        <span class="period">{exp.period}</span>
                    </div>
                    <div class="content">
                        <h3>{exp.title || exp.role}</h3>
                        {exp.company && <h4 class="company">{exp.company}</h4>}
                        <p>{exp.desc}</p>
                    </div>
                </button>
            ))
        }
    </div>
</section>

<style>
    #experience {
        padding: 6rem 0;
    }

    .header {
        display: flex;
        align-items: baseline;
        gap: 1rem;
        margin-bottom: 3rem;
        border-bottom: 1px solid var(--color-accent-subtle);
        padding-bottom: 1rem;
    }

    .mono {
        font-family: var(--font-mono);
        font-size: 0.9rem;
        color: var(--color-text-muted);
    }

    .timeline {
        display: flex;
        flex-direction: column;
        gap: 3rem;
    }

    .entry {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1rem;
        background: transparent;
        border: none;
        padding: 0;
        text-align: left;
        color: inherit;
        font: inherit;
    }

    .meta {
        font-size: 0.85rem;
        color: var(--color-text-muted);
    }

    h3 {
        font-size: 1.2rem;
        font-weight: 600;
        margin: 0 0 0.2rem 0;
        line-height: 1.2;
        min-height: 1.2em;
        display: block;
    }

    .company {
        font-size: 1rem;
        font-weight: 400;
        color: var(--color-text-muted);
        margin-bottom: 0.8rem;
    }

    p {
        font-size: 1rem;
        color: var(--color-text);
        margin: 0;
        max-width: 600px;
        line-height: 1.5;
    }

    @media (min-width: 768px) {
        .entry {
            grid-template-columns: 200px 1fr;
            gap: 2rem;
            cursor: pointer;
        }
    }

    .entry:hover h3,
    .entry:focus-visible h3 {
        color: #e7fff4;
        text-shadow:
            0 0 6px rgba(100, 255, 180, 0.25),
            0 0 14px rgba(100, 255, 180, 0.18);
    }

    .entry:hover .company,
    .entry:focus-visible .company {
        color: rgba(160, 255, 220, 0.7);
    }

    .entry:focus-visible {
        outline: 2px solid var(--color-text);
        outline-offset: 6px;
    }
</style>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const entries = document.querySelectorAll("#experience .entry");
        entries.forEach((entry) => {
            entry.addEventListener("click", () => {
                const dataStr = (entry as HTMLElement).dataset.hoverData;
                if (dataStr) {
                    try {
                        const data = JSON.parse(dataStr);
                        window.dispatchEvent(
                            new CustomEvent("open-overlay", { detail: data }),
                        );
                    } catch (e) {
                        console.error("Error parsing experience data", e);
                    }
                }
            });
        });
    });
</script>
