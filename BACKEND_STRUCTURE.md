# Backend Structure

This project is primarily static with minimal serverless API support.

## Runtime Model
- Static HTML/CSS/JS generated by Astro.
- Serverless API endpoints for dynamic data.
- No database. No persistent server processes.

## API Routes
Located in `src/pages/api/`.

### `GET /api/strava.json`
- File: `src/pages/api/strava.json.ts`
- Purpose: fetch latest Strava activities server-side.
- Cache: `s-maxage=1800` (30 minutes), `stale-while-revalidate=60`.

## Data Flow
1. Client loads the page.
2. The Lifestyle section requests `/api/strava.json`.
3. Serverless endpoint fetches Strava data and responds with JSON.
4. Client updates the Strava cube and refreshes every 30 minutes.

## Environment Variables
Required for Strava:
- `STRAVA_CLIENT_ID`
- `STRAVA_CLIENT_SECRET`
- `STRAVA_REFRESH_TOKEN`

## Error Handling
- If Strava fetch fails, the client preserves the existing UI state.
- The API returns an empty array on failure.

## Extending the Backend
- Add additional endpoints in `src/pages/api/`.
- Use cache headers to control freshness.
- Keep serverless functions small and deterministic.

## Deployment Notes
- Vercel serverless functions are recommended.
- Avoid long-running server logic.
